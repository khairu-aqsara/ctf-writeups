from pwn import *
from PIL import Image  
from pyzbar.pyzbar import decode
import time

width = 230
height = 230

r = remote('103.157.96.13', 7775)
r.recvline()
r.recvline()
r.recvline()
r.recvline()

def bacaQrCode():
	qr = r.recvuntil("Input: ")
	qr = qr.replace("\n\n\nInput: ","")
	qr = qr.replace('\x1b[0;37;47m','p' * 10)
	qr = qr.replace('\x1b[0;37;40m','h' * 10)
	qr = qr.replace(' ','')
	qr = qr.split()

	new_qr = []

	for x in qr:
		x = x.replace("\x1b[0m","")
		for i in range(10):
			new_qr.append(x)

	img  = Image.new( mode = "RGB", size = (width, height) )
	pixel = img.load()

	for x in range(width):
		for y in range(height):
			if new_qr[x][y] == 'p':
				pixel[x,y] = (255,255,255)
			else:
				pixel[x,y] = (0,0,0)
		
	text = decode(img)
	xx = text[0].data
	return xx



res = bacaQrCode()
flag = res
while(True):
	if '}' in flag:
		break

	r.sendline(res)
	res = bacaQrCode()
	flag+=res
	print flag
r.close()