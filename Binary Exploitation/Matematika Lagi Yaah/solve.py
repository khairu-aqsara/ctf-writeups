from pwn import *
import re

def jawabin_soal(soal):
    soal = soal.split(" ")
    a =  re.sub('[^0-9]','', soal[0])
    b =  re.sub('[^0-9]','', soal[2])
    operator = soal[1]
    jawab = eval("{a} {operator} {b}".format(a=a,b=b,operator=operator))
    
    return str(jawab)

   
conn = remote('103.157.96.13', 7771)
conn.recvuntil('\n')
conn.recvuntil('\n')
conn.recvuntil('\n')
conn.recvuntil('\n')
conn.recvuntil('\n')
nomor=1
while(True):
    soal = conn.recvline(keepends=False)
    soal = soal.decode("utf-8")
    log.info(soal)
    soal = soal.replace("Soal : ","")

    if 'CTFR' in soal:
        log.info(soal)
        break

    jawaban = jawabin_soal(soal)
    print(conn.recvuntil('Jawab : ').decode("utf-8") + jawaban)
    conn.sendline(str(jawaban))
    conn.recvuntil('\n')
    line = conn.recvline(keepends=False).decode("utf-8")

    if line != "Jawaban salah! Ulang dari awal yaa":
        if line != "Jawaban benar!":
            log.info(line)
            break
    else:
        print("Rest of stream: %s" & conn.recv())
        break
    nomor+=1