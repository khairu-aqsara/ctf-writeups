import requests
import re
import time
import os

URL = "https://web.ctf.rasyidmf.com/chal34/"
cookies = {}
final_score = 1
detik = 1

while(True):
    cmd = "./seeder.php {s} {d}".format(s=final_score, d=detik)
    tebakan = os.popen(cmd).read()
    data = {'t':tebakan}
    if len(cookies) > 0:
        x = requests.post(URL, data=data, cookies=cookies)
    else:
        x = requests.post(URL, data=data)
    response = x.text
    if len(cookies) == 0:
        c = str(x.cookies['PHPSESSID'])
        cookies['PHPSESSID'] = c
    tanggal = re.search(r'\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}', response)
    date = tanggal.group()
    print(date)
    date = int(date[-2:])
    detik = date
    skore = re.search(r'Skor : <b>(.*?)</b>', response)
    skor = skore.group()
    int_skore = re.search(r'[0-9]', skor)
    dec_skor = int_skore.group()
    final_score = int(dec_skor)
    if 'Here is your flag' in response:
        print(response)
        break
    print(final_score)
    time.sleep(2)