Sebelumnya nyaman dan damai yahh diselesaikannya. Coba sekarang yg ini lagi dehh :D.

link : https://web.ctf.rasyidmf.com/chal34/

```
<?php
SESSION::START();

    srand(intval(date("s")));
    $target = ["g", "b", "k"];
    $t = POST::GET("t");
    if ($t != "" && Sec::IsString($t) && strlen($t) == 1) {
        if (SESSION::GET("menang_v2") == "") {
            SESSION::SET("menang_v2", 1);
        }
        $res = "";
        for($i = 0; $i < intval(SESSION::GET("menang_v2")); $i++) {
            $res = $target[rand(0, 2)];
        }
        if ($res == $t) {
            echo "Selamat anda menang! <br><hr>";
            SESSION::SET("menang_v2", SESSION::GET("menang_v2") + 1);
        } else {
            SESSION::SET("menang_v2", 1);
            echo "Anda kalah! <br><hr>";
        }
    }

    if (SESSION::GET("menang_v2") == 10) {
        echo "Here is your flag : <b>CTFR{REDACTED}</b><br><hr>";
    }
?>
```

Local Version
```
<?php
session_start();
    
    $seed = intval(date("s"));
    srand($seed);
    echo "seed: <b>".$seed."</b><br/>";
    $target = ["g", "b", "k"];
    $t = @$_POST['t'];
    if ($t != "" && strlen($t) == 1) {
        if (isset($_SESSION['menang_v2']) && $_SESSION['menang_v2'] == "") {
            $_SESSION['menang_v2'] = 1;
        }
        $res = "";
        $jwb = '';
        for($i = 0; $i < intval(@$_SESSION['menang_v2']); $i++) {
            $jwb = rand(0, 2);
            $res = $target[$jwb];
        }
        if ($res == $t) {
            echo "Selamat anda menang! <br><hr>";
            $_SESSION['menang_v2'] = $_SESSION['menang_v2'] + 1;
        } else {
            $_SESSION['menang_v2'] = 1;
            echo "Anda kalah! <br><hr>";
        }
    }

    if ($_SESSION['menang_v2'] == 10) {
        echo "Here is your flag : <b>CTFR{REDACTED}</b><br><hr>";
    }

    echo "Skor : <b>".$_SESSION['menang_v2']."</b><br/>";
    echo "Jam :<b>". date('Y-m-d H:i:s')."</b>";
?>
```


Step:
```
Sycn Server Time
Produce Random Script
Brute
```

Code PHP Random
```
#!/usr/bin/php
<?php 

$skor = $argv[1];
$detik = $argv[2];

$detik = ($detik <=59) ? $detik+2 : 0;

$seed = intval(date("s"));
srand($detik);
$target = ["g", "b", "k"];

$res="";
for($i=0;$i<intval($skor); $i++){
	$jwb = rand(0, 2);
	$res = $target[$jwb];
}

echo $res;
```

Code Brute
```
import requests
import re
import time
import os

URL = "https://web.ctf.rasyidmf.com/chal34/"
cookies = {}
final_score = 1
detik = 1

while(True):
    cmd = "./seeder.php {s} {d}".format(s=final_score, d=detik)
    tebakan = os.popen(cmd).read()
    data = {'t':tebakan}
    if len(cookies) > 0:
        x = requests.post(URL, data=data, cookies=cookies)
    else:
        x = requests.post(URL, data=data)
    response = x.text
    if len(cookies) == 0:
        c = str(x.cookies['PHPSESSID'])
        cookies['PHPSESSID'] = c
    tanggal = re.search(r'\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}', response)
    date = tanggal.group()
    print(date)
    date = int(date[-2:])
    detik = date
    skore = re.search(r'Skor : <b>(.*?)</b>', response)
    skor = skore.group()
    int_skore = re.search(r'[0-9]', skor)
    dec_skor = int_skore.group()
    final_score = int(dec_skor)
    if 'Here is your flag' in response:
        print(response)
        break
    print(final_score)
    time.sleep(2)
```

Flag
```
CTFR{th15_4_ju5t_b391nn19_0f_p53ud0r4nd0m}
```