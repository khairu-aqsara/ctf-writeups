from pwn import *
from z3 import *

FLAG_SIZE = 46
f = [BitVec(i, 16) for i in range(FLAG_SIZE)]
SOLVER = Solver()

for x in range(FLAG_SIZE):
    SOLVER.add(47 < f[x])
    SOLVER.add(126 > f[x])
    SOLVER.add(64 != f[x],
        96 != f[x],
        ord('[') != f[x],
        ord(']') != f[x],
        ord('<') != f[x],
        ord('>') != f[x],
        ord(':') != f[x],
        ord('^') != f[x],
        ord(';') != f[x],
        ord('=') != f[x],
        ord('\\') != f[x],
        ord('#') != f[x],
        ord('|') != f[x],
        ord('?') != f[x])

SOLVER.add(f[31] == 51) 
SOLVER.add(f[21] == 110) 
SOLVER.add(f[11] % (f[40] * f[16]) == 117) 
SOLVER.add((f[37] + f[33]) % (f[31] + f[41]) == 59) 
SOLVER.add(f[43] % (f[2] - f[6]) == 4) 
SOLVER.add(f[16] * f[44] == 5100) 
SOLVER.add((f[36] % f[35]) - (f[30] - f[0]) == -4) 
SOLVER.add((f[6] - f[11]) - (f[35] * f[28]) == -5985) 
SOLVER.add(f[2] * (f[32] * f[31]) == 353430) 
SOLVER.add(f[14] - (f[44] % f[41]) == 10) 
SOLVER.add(f[9] % f[36] == 26) 
SOLVER.add(f[45] - f[33] == 8) 
SOLVER.add(f[11] == 117) 
SOLVER.add(f[14] - (f[37] * f[11]) == -12994) 
SOLVER.add(f[7] == 119) 
SOLVER.add(f[45] == 125) 
SOLVER.add(f[31] == 51) 
SOLVER.add((f[1] * f[34]) % (f[6] * f[21]) == 4296) 
SOLVER.add((f[38] - f[10]) % (f[6] * f[13]) == 4) 
SOLVER.add(f[10] - f[42] == 0) 
SOLVER.add(f[30] - (f[37] % f[9]) == 3) 
SOLVER.add((f[11] % f[42]) % (f[4] - f[40]) == 21) 
SOLVER.add(f[38] * (f[16] * f[20]) == 137904) 
SOLVER.add((f[42] - f[38]) - (f[18] % f[40]) == -13) 
SOLVER.add(f[12] % f[40] == 42) 
SOLVER.add((f[22] + f[44]) * (f[11] + f[15]) == 43400) 
SOLVER.add(f[9] + (f[43] % f[28]) == 235) 
SOLVER.add(f[41] % (f[33] + f[16]) == 119) 
SOLVER.add((f[34] + f[30]) % (f[37] + f[6]) == 69) 
SOLVER.add(f[37] % f[41] == 112) 
SOLVER.add(f[36] == 95) 
SOLVER.add(f[17] - (f[34] % f[1]) == 84) 
SOLVER.add(f[24] - (f[14] * f[0]) == -7318) 
SOLVER.add(f[37] * f[15] == 11200) 
SOLVER.add(f[29] % f[19] == 95) 
SOLVER.add(f[27] + (f[28] - f[20]) == 181) 
SOLVER.add(f[32] == 99) 
SOLVER.add(f[26] - f[18] == -67) 
SOLVER.add(f[14] == 110) 
SOLVER.add(f[32] == 99) 
SOLVER.add(f[32] == 99) 
SOLVER.add(f[42] - f[25] == -50) 
SOLVER.add((f[42] + f[31]) - (f[39] * f[15]) == -5201) 
SOLVER.add(f[39] % f[5] == 53) 
SOLVER.add(f[22] * f[37] == 11200) 
SOLVER.add(f[7] % f[4] == 119) 
SOLVER.add(f[44] + (f[26] * f[30]) == 5620) 
SOLVER.add((f[36] % f[40]) - (f[31] % f[9]) == -9) 
SOLVER.add((f[41] % f[15]) % (f[22] + f[42]) == 19) 
SOLVER.add(f[30] * (f[6] + f[4]) == 19665) 
SOLVER.add(f[23] + f[17] == 209) 
SOLVER.add(f[43] % f[23] == 19) 
SOLVER.add((f[32] - f[26]) * (f[5] * f[16]) == 286110) 
SOLVER.add((f[35] * f[38]) % (f[41] * f[10]) == 2652) 
SOLVER.add(f[18] + (f[43] % f[2]) == 159) 
SOLVER.add((f[5] % f[6]) % (f[19] - f[7]) == -1) 
SOLVER.add((f[32] + f[1]) - (f[37] - f[33]) == 188) 
SOLVER.add(f[31] % (f[10] - f[3]) == -17) 
SOLVER.add((f[28] + f[26]) - (f[31] % f[16]) == 164) 
SOLVER.add(f[12] % f[0] == 28) 
SOLVER.add((f[9] + f[22]) % (f[13] + f[21]) == 221) 
SOLVER.add((f[38] % f[39]) * (f[43] - f[6]) == 3432) 
SOLVER.add(f[4] - f[0] == 56) 
SOLVER.add(f[15] - f[31] == 49) 
SOLVER.add(f[45] % f[25] == 27) 
SOLVER.add(f[22] - f[23] == 5) 
SOLVER.add((f[19] - f[33]) + (f[45] - f[20]) == 72) 
SOLVER.add(f[37] * (f[11] % f[31]) == 1680) 
SOLVER.add(f[19] % f[10] == 20) 
SOLVER.add(f[11] - f[22] == 17) 
SOLVER.add(f[44] * f[17] == 11400) 
SOLVER.add(f[2] - (f[44] - f[16]) == 21) 
SOLVER.add(f[28] + f[23] == 211) 
SOLVER.add(f[22] - (f[3] - f[32]) == 117) 
SOLVER.add(f[12] + (f[0] * f[45]) == 8470) 
SOLVER.add((f[11] - f[26]) - (f[3] + f[38]) == -65) 
SOLVER.add(f[28] + (f[0] - f[28]) == 67) 
SOLVER.add(f[14] - (f[26] * f[6]) == -2194) 
SOLVER.add(f[26] - (f[45] - f[11]) == 40) 
SOLVER.add((f[33] - f[31]) - (f[35] * f[37]) == -5646) 
SOLVER.add(f[40] + (f[23] + f[29]) == 243) 
SOLVER.add(f[14] * (f[7] * f[8]) == 1243550) 
SOLVER.add(f[35] - f[5] == -59) 
SOLVER.add(f[31] % f[41] == 51) 
SOLVER.add(f[38] % (f[43] % f[21]) == 0) 
SOLVER.add(f[2] % (f[3] % f[23]) == 70) 
SOLVER.add((f[14] + f[23]) % (f[40] - f[33]) == -51) 
SOLVER.add(f[10] * (f[7] - f[37]) == 336) 
SOLVER.add(f[26] * (f[18] + f[23]) == 10080) 
SOLVER.add(f[21] * (f[33] + f[10]) == 18150) 
SOLVER.add(f[8] - f[21] == -15) 
SOLVER.add((f[2] % f[5]) - (f[2] * f[22]) == -6930) 
SOLVER.add(f[2] * f[34] == 7980) 
SOLVER.add(f[24] + f[5] == 162) 
SOLVER.add(f[8] % f[23] == 0) 
SOLVER.add(f[3] % f[38] == 30) 
SOLVER.add(f[43] - f[11] == -3) 
SOLVER.add(f[19] + (f[10] * f[36]) == 4676) 
SOLVER.add((f[44] % f[38]) + (f[26] - f[3]) == 14) 
SOLVER.add((f[15] % f[11]) % (f[39] + f[39]) == 100) 
SOLVER.add(f[12] - (f[32] * f[28]) == -11389) 
SOLVER.add(f[13] + (f[34] * f[38]) == 6045) 
SOLVER.add(f[32] * f[13] == 11583) 
SOLVER.add(f[37] % f[11] == 112) 
SOLVER.add(f[33] * (f[21] + f[16]) == 18837) 
SOLVER.add(f[7] + f[2] == 189) 
SOLVER.add((f[4] * f[8]) * (f[45] * f[40]) == 77413125) 
SOLVER.add(f[5] - (f[18] * f[7]) == -13575) 
SOLVER.add((f[42] + f[45]) - (f[26] % f[39]) == 125) 
SOLVER.add((f[35] * f[30]) * (f[42] * f[22]) == 28152000) 
SOLVER.add(f[10] - f[36] == -47) 
SOLVER.add(f[30] + f[5] == 225) 
SOLVER.add(f[17] + (f[31] % f[3]) == 165) 
SOLVER.add(f[12] * (f[26] * f[44]) == 456000) 
SOLVER.add(f[26] + f[20] == 100) 
SOLVER.add((f[0] - f[5]) * (f[27] + f[38]) == -7267) 
SOLVER.add(f[11] - (f[35] - f[29]) == 161) 
SOLVER.add(f[39] - f[33] == -64) 
SOLVER.add(f[44] + f[24] == 152) 
SOLVER.add(f[24] - f[26] == 4) 
SOLVER.add(f[34] * f[25] == 11172) 
SOLVER.add(f[15] - f[0] == 33) 
SOLVER.add((f[12] + f[9]) % (f[14] % f[4]) == 106) 
SOLVER.add(f[15] + (f[6] * f[5]) == 5380) 
SOLVER.add((f[7] * f[36]) - (f[17] * f[45]) == -2945) 
SOLVER.add(f[6] - f[2] == -22) 
SOLVER.add(f[36] % f[33] == 95) 
SOLVER.add((f[3] - f[0]) - (f[45] - f[43]) == 4) 
SOLVER.add(f[0] * (f[39] + f[14]) == 10921) 
SOLVER.add(f[22] * f[13] == 11700) 
SOLVER.add(f[37] * (f[32] % f[23]) == 448) 
SOLVER.add(f[22] * f[18] == 11500) 
SOLVER.add(f[26] % f[35] == 48) 
SOLVER.add((f[41] % f[17]) + (f[10] * f[26]) == 2309) 
SOLVER.add(f[1] * (f[21] % f[26]) == 1176) 
SOLVER.add(f[42] - (f[41] % f[0]) == -4) 
SOLVER.add((f[30] % f[38]) + (f[20] - f[37]) == -49) 
SOLVER.add(f[26] - f[17] == -66) 
SOLVER.add(f[28] * f[31] == 5916) 
SOLVER.add((f[20] - f[34]) + (f[28] - f[35]) == 3) 
SOLVER.add(f[20] * (f[17] + f[30]) == 11908) 
SOLVER.add(f[29] * (f[7] - f[22]) == 1805) 
SOLVER.add(f[36] - f[16] == 44) 
SOLVER.add(f[14] * f[44] == 11000) 
SOLVER.add(f[13] - (f[1] + f[19]) == -83) 
SOLVER.add((f[16] % f[7]) * (f[26] % f[20]) == 2448) 
SOLVER.add((f[32] % f[17]) - (f[36] - f[35]) == 55) 
SOLVER.add(f[19] * (f[8] * f[29]) == 1046900) 
SOLVER.add(f[32] * f[11] == 11583) 
SOLVER.add(f[20] % f[9] == 52) 
SOLVER.add(f[19] * (f[2] % f[42]) == 2552) 
SOLVER.add(f[38] + (f[35] % f[19]) == 103) 
SOLVER.add((f[39] + f[38]) - (f[7] * f[17]) == -13461) 
SOLVER.add(f[14] % f[5] == 0) 
SOLVER.add((f[15] - f[44]) + (f[32] + f[42]) == 147) 
SOLVER.add(f[17] % f[17] == 0) 
SOLVER.add((f[24] * f[25]) - (f[12] + f[25]) == 4903) 
SOLVER.add((f[38] % f[32]) * (f[6] * f[34]) == 284544) 
SOLVER.add((f[29] + f[25]) % (f[33] + f[15]) == 193) 
SOLVER.add(f[14] * (f[9] - f[22]) == 2310) 
SOLVER.add(f[28] % (f[3] + f[16]) == 116) 
SOLVER.add(f[7] * f[17] == 13566) 
SOLVER.add(f[17] * (f[22] * f[35]) == 581400) 
SOLVER.add(f[43] - f[2] == 44) 
SOLVER.add(f[35] % (f[23] * f[27]) == 51) 
SOLVER.add(f[0] * f[17] == 7638) 
SOLVER.add(f[18] * (f[29] % f[18]) == 10925) 
SOLVER.add((f[17] * f[38]) % (f[41] - f[21]) == 6) 
SOLVER.add(f[14] % (f[20] * f[6]) == 110) 
SOLVER.add((f[24] * f[14]) * (f[14] % f[1]) == 148720) 
SOLVER.add(f[37] * (f[26] + f[19]) == 18368) 
SOLVER.add((f[4] * f[1]) * (f[15] + f[11]) == 2242044) 
SOLVER.add((f[29] + f[23]) + (f[2] + f[35]) == 311) 
SOLVER.add((f[13] + f[16]) - (f[38] + f[41]) == -3) 
SOLVER.add(f[10] - (f[44] - f[23]) == 43) 
SOLVER.add((f[38] - f[16]) + (f[12] * f[15]) == 9501) 
SOLVER.add((f[39] - f[32]) * (f[22] % f[28]) == -4600) 
SOLVER.add(f[37] - (f[14] * f[24]) == -5608) 
SOLVER.add(f[33] + f[40] == 170) 
SOLVER.add(f[25] % (f[23] * f[3]) == 98) 
SOLVER.add(f[41] - (f[34] % f[42]) == 101) 
SOLVER.add(f[36] + f[26] == 143) 
SOLVER.add((f[38] + f[7]) + (f[5] * f[9]) == 13481) 
SOLVER.add((f[17] - f[36]) * (f[16] + f[12]) == 2774) 
SOLVER.add(f[17] + (f[17] - f[7]) == 109) 
SOLVER.add(f[33] - (f[44] % f[5]) == 17) 
SOLVER.add(f[42] + f[11] == 165) 
SOLVER.add((f[0] % f[32]) % (f[10] * f[36]) == 67) 
SOLVER.add((f[18] % f[17]) + (f[2] % f[37]) == 71) 
SOLVER.add(f[6] + f[7] == 167) 
SOLVER.add((f[20] - f[1]) * (f[0] % f[45]) == -2144) 
SOLVER.add((f[42] % f[39]) * (f[43] % f[33]) == 5472) 
SOLVER.add(f[40] * f[7] == 6307) 
SOLVER.add((f[14] - f[0]) - (f[36] % f[7]) == -52) 
SOLVER.add(f[40] % (f[13] * f[40]) == 53) 
SOLVER.add(f[38] % f[7] == 52) 
SOLVER.add(f[3] * (f[11] - f[29]) == 1804) 
SOLVER.add((f[8] - f[9]) * (f[19] * f[6]) == -144768) 
SOLVER.add(f[17] + (f[26] % f[19]) == 162) 
SOLVER.add(f[44] + f[42] == 148) 
SOLVER.add((f[39] * f[24]) * (f[33] + f[15]) == 598052) 
SOLVER.add(f[38] - (f[7] - f[1]) == 17) 
SOLVER.add(f[30] - (f[0] + f[41]) == -71) 
SOLVER.add(f[42] % f[15] == 48) 
SOLVER.add(f[41] + (f[43] - f[16]) == 182) 
SOLVER.add((f[15] * f[1]) + (f[33] % f[1]) == 8433) 
SOLVER.add(f[26] % (f[17] * f[35]) == 48) 
SOLVER.add(f[4] % f[17] == 9) 
SOLVER.add(f[22] % f[13] == 100) 
SOLVER.add((f[38] - f[10]) - (f[38] * f[34]) == -5924) 
SOLVER.add(f[30] - f[22] == 15) 
SOLVER.add(f[7] - (f[31] + f[28]) == -48) 
SOLVER.add((f[17] + f[3]) - (f[18] + f[22]) == -19) 
SOLVER.add((f[32] + f[33]) - (f[0] * f[20]) == -3268) 
SOLVER.add(f[12] - (f[7] % f[44]) == 76) 
SOLVER.add(f[11] * f[34] == 13338) 
SOLVER.add(f[38] * f[25] == 5096) 
SOLVER.add(f[38] % (f[23] * f[21]) == 52) 
SOLVER.add((f[9] % f[13]) % (f[2] % f[3]) == 4) 
SOLVER.add(f[1] % (f[29] + f[13]) == 84) 
SOLVER.add((f[5] + f[23]) % (f[19] - f[20]) == 13) 
SOLVER.add(f[18] + (f[43] % f[43]) == 115) 
SOLVER.add(f[8] + f[0] == 162) 
SOLVER.add(f[42] % (f[9] - f[35]) == 48) 
SOLVER.add(f[42] % f[26] == 0) 
SOLVER.add(f[18] * (f[45] + f[13]) == 27830) 
SOLVER.add((f[21] % f[30]) - (f[11] + f[10]) == -55) 
SOLVER.add(f[39] - (f[24] + f[31]) == -50) 
SOLVER.add((f[22] + f[43]) % (f[23] + f[30]) == 4) 
SOLVER.add(f[41] * f[36] == 11305) 
SOLVER.add(f[20] - (f[29] + f[45]) == -168) 
SOLVER.add(f[15] % (f[34] * f[39]) == 100) 
SOLVER.add(f[38] * f[19] == 6032) 
SOLVER.add((f[10] - f[31]) - (f[18] + f[7]) == -237) 
SOLVER.add((f[39] * f[1]) + (f[5] % f[45]) == 4562) 
SOLVER.add((f[27] * f[38]) - (f[38] - f[21]) == 6142) 
SOLVER.add((f[32] - f[4]) * (f[31] * f[5]) == -134640) 
SOLVER.add(f[12] % f[33] == 95) 
SOLVER.add(f[34] - (f[45] * f[21]) == -13636) 
SOLVER.add(f[14] * (f[12] - f[42]) == 5170) 
SOLVER.add(f[34] * f[37] == 12768) 
SOLVER.add((f[36] * f[23]) % (f[30] + f[19]) == 16) 
SOLVER.add(f[13] + (f[10] % f[17]) == 165) 
SOLVER.add(f[4] % (f[35] * f[12]) == 123) 
SOLVER.add((f[39] % f[9]) % (f[24] + f[22]) == 53) 
SOLVER.add(f[13] % f[1] == 33) 
SOLVER.add((f[31] - f[31]) - (f[10] - f[33]) == 69) 
SOLVER.add((f[16] * f[17]) - (f[23] - f[28]) == 5835) 
SOLVER.add((f[42] * f[21]) + (f[41] % f[36]) == 5304) 
SOLVER.add((f[19] + f[28]) + (f[20] + f[32]) == 383) 
SOLVER.add((f[12] * f[22]) - (f[1] * f[2]) == 3620) 
SOLVER.add((f[17] % f[39]) * (f[24] + f[9]) == 1384) 
SOLVER.add(f[34] - f[10] == 66) 
SOLVER.add((f[21] + f[21]) - (f[37] - f[19]) == 224) 
SOLVER.add((f[8] + f[30]) * (f[4] % f[38]) == 3990) 
SOLVER.add(f[33] + (f[6] - f[23]) == 70) 
SOLVER.add((f[18] - f[35]) + (f[45] % f[39]) == 83) 
SOLVER.add(f[25] * (f[24] + f[31]) == 10094) 
SOLVER.add(f[43] * (f[9] * f[35]) == 703494) 
SOLVER.add(f[21] + f[14] == 220) 
SOLVER.add(f[37] + (f[25] + f[3]) == 292) 
SOLVER.add(f[4] - f[14] == 13) 
SOLVER.add((f[45] % f[20]) % (f[0] * f[9]) == 21) 
SOLVER.add(f[21] + (f[36] - f[5]) == 95) 
SOLVER.add((f[25] - f[21]) + (f[29] * f[33]) == 11103) 
SOLVER.add((f[28] + f[45]) + (f[6] - f[1]) == 205) 
SOLVER.add((f[21] - f[17]) * (f[17] % f[25]) == -64) 
SOLVER.add(f[12] - f[30] == -20) 
SOLVER.add(f[40] * f[25] == 5194) 
SOLVER.add(f[4] - f[16] == 72) 
SOLVER.add(f[8] * (f[19] * f[32]) == 1090980) 
SOLVER.add(f[36] + f[44] == 195) 
SOLVER.add(f[7] + f[10] == 167) 
SOLVER.add((f[6] - f[35]) - (f[26] + f[2]) == -121) 
SOLVER.add((f[43] * f[39]) * (f[27] + f[10]) == 996930) 
SOLVER.add((f[37] - f[34]) + (f[44] * f[37]) == 11198) 
SOLVER.add(f[43] * (f[19] + f[29]) == 24054) 
SOLVER.add(f[32] + (f[15] * f[24]) == 5299) 
SOLVER.add(f[16] - (f[17] * f[37]) == -12717) 
SOLVER.add(f[7] * (f[30] - f[12]) == 2380) 
SOLVER.add(f[37] % (f[20] - f[1]) == -16) 
SOLVER.add((f[5] + f[27]) + (f[2] + f[16]) == 348) 
SOLVER.add(f[31] + (f[23] % f[12]) == 51) 
SOLVER.add(f[34] + f[4] == 237) 
SOLVER.add(f[36] * (f[44] * f[28]) == 1102000) 
SOLVER.add((f[32] * f[41]) + (f[4] % f[42]) == 11808) 
SOLVER.add(f[33] + (f[41] % f[7]) == 117) 
SOLVER.add((f[36] % f[32]) % (f[8] % f[32]) == 0) 
SOLVER.add((f[12] + f[2]) * (f[36] % f[41]) == 15675) 
SOLVER.add(f[41] * (f[35] - f[43]) == -7497) 

while True:
    checkSolver = SOLVER.check()
    model = SOLVER.model()
    temp = [0 for x in range(FLAG_SIZE)]
    for x in range(FLAG_SIZE):
        # Mengambil Inputan yang di solve oleh z3
        i = eval(str(
            model[x])[2:]
        )
        temp[i] = eval(str(model[model[x]]))
    prbflag = ''.join(chr(temp[i]) for i in range(FLAG_SIZE))
    if "CTFR" in prbflag:
        log.success("Flag : " + prbflag)
        exit(0)