Mimin lupa pin kartu atm mimin :(, bisa bantuin carikan kagak!!! Pin mimin ke ubah menjadi 

```
d4bda24e01862a065ed844be0ec49269e7d316ab21cfc713
7f77df63638951ee1358ea1bd7450cd37ff575bbbf9
94b7533c207da1abc08aa87c1561e1a641df8
```
saat mimin ingin mendapatkan ulang pin nya :(.

Link : https://web.ctf.rasyidmf.com/chal38/

```
function rand(min, max) { return Math.floor(Math.random() * (max - min) ) + min; }
function chr(x) { return String.fromCharCode(x); }
function ord(x) { return x.charCodeAt(0); }
function pow(x, y) { return Math.pow(x, y); }
function getChar() { var _0x8736=["\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6A\x6B\x6C\x6D\x6E\x6F\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7A\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4A\x4B\x4C\x4D\x4E\x4F\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5A\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2A\x2B\x2C\x2D\x2E\x2F\x3A\x3B\x3C\x3D\x3E\x3F\x40\x5B\x5C\x5D\x5E\x5F\x60\x7B\x7C\x7D\x7E\x20\x09\x0A\x0D\x0B\x0C"];return _0x8736[0]; }
function getCure(x) { if (x > 0x2710) { return getCure(x / 2); } else { return x; } }
function getHexChar(x) { return "abcdef0123456789"; }
function genPrime(byte) {
	result = [];
	for (var x = 1; x <= byte; x++) {
		var p = false;
		for (var i = 2; i <= x; i++) {
			if (x % i === 0 && i !== x) {
				p = true;
			}
		}
		if (p === false) result.push(x);
	}
	return result;
}
function genFuture(x) {
	x = x.toString();
	var future1 = [];
	var future2 = [];
	var future3 = [];
	if (x.length == 3) {
		future1 = genPrime(getCure(ord(x[0]) << 0xF));
		future2 = genPrime(getCure(ord(x[1]) << 0xF));
		future3 = genPrime(getCure(ord(x[2]) << 0xF));
		var res = [];
		var a = 0;
		var b = 1;
		for(var c = 0; c < getChar().length; c++) {
			for(var f = 0; f < future1.length; f++) {
				var calc = (pow(future1[f] % getChar()[c], c));
				if (calc == 0x200 || calc == 0xf3 || calc == 0x400 || calc ==  0x3d09 || calc == 0x1312d || calc == 0x8000000) { a += 1; }
				else { b += 2;}
			}
		}
		var h = a * b;
		h = h.toString(16);
		if (h.toString().length != 10) {
			h = h.toString();
			for(var x = h.length; x < 10; x++) {
				h += getHexChar()[rand(0, getHexChar().length)];
			}
		}
		res.push(h);
		var a = 0;
		var b = 1;
		for(var c = 0; c < getChar().length; c++) {
			for(var f = 0; f < future2.length; f++) {
				var calc = (pow(future2[f] % getChar()[c], c));
				if (calc == 0x200 || calc == 0xf3 || calc == 0x400 || calc ==  0x3d09 || calc == 0x1312d || calc == 0x8000000) { a += 1; }
				else { b += 2;}
			}
		}
		var h = a * b;
		h = h.toString(16);
		if (h.toString().length != 10) {
			h = h.toString();
			for(var x = h.length; x < 10; x++) {
				h += getHexChar()[rand(0, getHexChar().length)];
			}
		}
		res.push(h);
		var a = 0;
		var b = 1;
		for(var c = 0; c < getChar().length; c++) {
			for(var f = 0; f < future3.length; f++) {
				var calc = (pow(future3[f] % getChar()[c], c));
				if (calc == 0x200 || calc == 0xf3 || calc == 0x400 || calc ==  0x3d09 || calc == 0x1312d || calc == 0x8000000) { a += 1; }
				else { b += 2;}
			}
		}
		var h = a * b;
		h = h.toString(16);
		if (h.toString().length != 10) {
			h = h.toString();
			for(var x = h.length; x < 10; x++) {
				h += getHexChar()[rand(0, getHexChar().length)];
			}
		}
		res.push(h);
		return res;
	} else {
		return "Disallow future!";
	}
}
function Encrypt(pin) {
	for(var ttt = 0; ttt < 1000; ttt++) debugger;
	pin = pin.toString();
	var future1 = genFuture(pin.substr(0, 3));
	var future2 = genFuture(pin.substr(3, 6));
	var finalfuture = "";
	for(var x = 0; x < 3; x++) {
		finalfuture += future1[x];
	}
	for(var x = 0; x < 3; x++) {
		finalfuture += future2[x];
	}
	for(var x = 0; x < 4; x++) {
		finalfuture += getHexChar()[rand(0, getHexChar().length)];
	}
	var final_future = "";
	for(var x = 0; x < 32; x++) {
		final_future += getHexChar()[rand(0, getHexChar().length)];
	}
	var final_future2 = "";
	for(var x = 0; x < 32; x++) {
		final_future2 += getHexChar()[rand(0, getHexChar().length)];
	}
	return final_future + finalfuture + final_future2;
}
var pin_mimin = "d4bda24e01862a065ed844be0ec49269e7d316ab21cfc7137f77df63638951ee1358ea1bd7450cd37ff575bbbf994b7533c207da1abc08aa87c1561e1a641df8";
function CheckPin() {
	var currPin = $(".pin").val();
	if (currPin == "") {
		alert("Pin masih kosong!");
	} else if (currPin.length != 6) {
		alert("Panjang Pin tidak valid!");
	} else if (!(/^\d+$/.test(currPin))) {
		alert("Pin harus berupa angka!");
	} else {
		var enc = Encrypt(currPin);
		$(".currpin").html(enc);
		if (enc == pin_mimin) {
			alert("Pinnya valid!");
		} else {
			alert("Pinnya tidak valid!");
		}
	}
}
```

```
function brute(ke){
	var pin_a = pin_mimin.substr(32,30)
	var pin_b = pin_mimin.substr(62,30)
	var pinya = Encrypt(ke)
	var pinya_a = pinya.substr(32,30)
	var pinya_b = pinya.substr(62,30)

	var km1 = pin_a.substr(3,4)
	var km2 = pin_a.substr(13,4)
	var km3 = pin_a.substr(23,4)

	var km4 = pin_b.substr(3,4)
	var km5 = pin_b.substr(13,4)
	var km6 = pin_b.substr(23,4)

	var m1 = pinya_a.substr(3,4)
	var m2 = pinya_a.substr(13,4)
	var m3 = pinya_a.substr(23,4)

	var m4 = pinya_b.substr(3,4)
	var m5 = pinya_b.substr(13,4)
	var m6 = pinya_b.substr(23,4)
	
	console.log(pin_mimin)
	console.log(pinya)
	console.log("mm : " + pin_a, pin_b)
	console.log("pp : " + pinya_a, pinya_b)
	console.log("m : " + km1, km2, km3, km4, km5, km6)
	console.log("p : " + m1, m2, m3, m4, m5, m6)
}
```

Flag
```
CTFR{746859}
```
